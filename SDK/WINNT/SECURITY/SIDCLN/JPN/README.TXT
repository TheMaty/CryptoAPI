サンプル: Win32 セキュリティ API 関数のデモ

要約:

SIDCLN サンプル プログラムはいくつかの Win32 セキュリティ API 関数
のデモを行います。また、ディスク上に割り当てたリソースを残したまま
アカウントを削除したときに、ディスク上に残っているリソースを回復す
るユーティリティの書き方の実例となります。

詳細:

回復されたディスク上のリソースとは:

	削除されたアカウントに所有されたままのファイルの所有権は、
	このサンプルを実行したときにログオンしているアカウントに
	割り当てられます。

	削除されたアカウントの ACEは、ファイルの ACL から編集 (削除) 
	されます（削除されたアカウントに権限（Read access など）が
	与えられていたとき）。

このサンプルを多くの環境でユーティリティとして走らせること
は、実質的な価値はたぶんありません。削除されたユーザー 
アカウントに所属していたファイルの数は大変少ないことが多い
ですし、削除されたアカウントのために、ACE を編集することに
よってディスク上で回復されるバイト数は、このサンプルを走ら
せるのにかかる時間ほど多くはありません。ハード ディスク全体
やパーティション全体に対してこのサンプルを走らせたときの時間
は大変重大でしょう。

注意: このサンプルはサポートの行なわれないユーティリティーです。

実行するには:

	管理者のアカウントでログオンしなければなりません。なぜなら、
	管理者アカウントは、ACLを編集したり、ファイルの所有権を
	操作したりする権限を持っているからです。

	このサンプルの ACL の編集部分は、そのファイルが NTFS 上の
	パーティションにあり、NT が操作している ACL もそこにある
	ときだけ効力があります。

典型的なテスト シナリオ:
ユーザー アカウントを 1 つか 2 つ作成し、それらのアカウントでログオン
し、それぞれのアカウントでログオン中に、NTFS パーティションで 2 つの
ファイルを作成します。これにより、テスト アカウントはいくつかのファイル
を所有します。ファイル マネージャを使って、これらのファイルのアクセス権
を編集します。これにより、それぞれのテスト ユーザーは、ファイルに対して
いくつかの明示的に与えられた権限（Read など）を持ちます。管理者として
ログオンし、それぞれのテスト ユーザーに、管理者が所有しているいくつかの
ファイルに対する権限を与えます。テスト アカウントを削除します。テスト 
アカウントが所有していたファイルの置かれたディレクトリか、権限が与えられ
ていたファイルのあったディレクトリでこのサンプルを走らせます。